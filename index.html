<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스포츠박스 하계 이벤트 신청</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec"></script>
    <script>tailwind.config={theme:{extend:{colors:{primary:'#3b82f6',secondary:'#f59e0b'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="icon" href="https://raw.githubusercontent.com/sportsbox031/event/main/KakaoTalk_20250423_132034560.png" type="image/png">
    <style>
        :where([class^="ri-"])::before { content: "\f3c2"; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f9fafb;
        }
        .calendar-day {
            transition: all 0.3s ease;
        }
        .calendar-day.highlight {
            background-color: rgba(59, 130, 246, 0.1);
            border-color: #3b82f6;
        }
        .calendar-day.selected {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        input:focus {
            outline: none;
            border-color: #3b82f6;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .admin-login-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 0.8em;
            margin-top: 10px;
            text-decoration: underline;
        }
        .admin-login-btn:hover {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex flex-col">
        <!-- 헤더/네비게이션 바 추가 -->
<header class="bg-white shadow-sm py-4 px-4 md:px-8">
    <div class="container mx-auto max-w-6xl flex items-center justify-between">
        <a href="#" class="flex items-center">
            <img src="https://raw.githubusercontent.com/sportsbox031/event/main/KakaoTalk_20250423_132034560.png" alt="스포츠박스 로고" class="h-12 w-auto">
        </a>
        <div class="text-right">
            <span class="text-gray-700">문의: 031-250-0474~7</span>
        </div>
    </div>
</header>
        <!-- Hero Section -->
        <div class="w-full bg-gradient-to-r from-blue-50 to-blue-100 py-16">
            <div class="container mx-auto px-4 md:px-8 max-w-6xl">
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="md:w-1/2 mb-8 md:mb-0">
                        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">스포츠박스 하계 이벤트</h1>
                        <p class="text-xl text-gray-700 mb-6">2025년 7월 7일 - 7월 9일</p>
                        <!-- 예약 상태 표시 추가 -->
                        <div id="reservationStatusDisplay" class="mb-4 p-3 rounded-lg text-center">
                            <div class="inline-flex items-center px-4 py-2 rounded-full">
                                <span class="mr-2">예약 상태:</span>
                                <span id="statusText" class="font-semibold">확인 중...</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                            <div class="flex items-center mb-2">
                                <div class="w-8 h-8 flex items-center justify-center bg-primary rounded-full text-white mr-3">
                                    <i class="ri-user-line"></i>
                                </div>
                                <p class="text-gray-700">각 차수별 최대 인원: <span class="font-semibold">50명</span></p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-8 h-8 flex items-center justify-center bg-primary rounded-full text-white mr-3">
                                    <i class="ri-calendar-line"></i>
                                </div>
                                <p class="text-gray-700">1차(7/7), 2차(7/8), 3차(7/9)</p>
                            </div>
                        </div>
                    </div>
                    <div class="md:w-5/12">
                        <img src="https://raw.githubusercontent.com/sportsbox031/event/main/IMG_1463.JPG" alt="하계 이벤트 이미지" class="rounded-lg shadow-lg w-full h-auto object-cover object-center">
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container mx-auto px-4 md:px-8 max-w-6xl py-12">
            <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 md:p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">이벤트 신청하기</h2>
                
                <!-- Calendar Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">참가 날짜 선택</h3>
                    <div class="bg-gray-50 rounded-lg p-4 md:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-lg font-medium text-gray-800">2025년 7월</h4>
                        </div>
                        
                        <!-- Calendar Header -->
                        <div class="grid grid-cols-7 gap-1 mb-2">
                            <div class="text-center text-sm font-medium text-gray-500">일</div>
                            <div class="text-center text-sm font-medium text-gray-500">월</div>
                            <div class="text-center text-sm font-medium text-gray-500">화</div>
                            <div class="text-center text-sm font-medium text-gray-500">수</div>
                            <div class="text-center text-sm font-medium text-gray-500">목</div>
                            <div class="text-center text-sm font-medium text-gray-500">금</div>
                            <div class="text-center text-sm font-medium text-gray-500">토</div>
                        </div>
                        
                        <!-- Calendar Days -->
                        <div class="grid grid-cols-7 gap-1">
                            <!-- Week 1 -->
                            <div class="h-12 flex items-center justify-center text-gray-400">29</div>
                            <div class="h-12 flex items-center justify-center text-gray-400">30</div>
                            <div class="h-12 flex items-center justify-center">1</div>
                            <div class="h-12 flex items-center justify-center">2</div>
                            <div class="h-12 flex items-center justify-center">3</div>
                            <div class="h-12 flex items-center justify-center">4</div>
                            <div class="h-12 flex items-center justify-center">5</div>
                            
                            <!-- Week 2 (Event Days) -->
                            <div class="h-12 flex items-center justify-center">6</div>
                            <div class="calendar-day h-12 flex items-center justify-center rounded-full border-2 border-transparent cursor-pointer highlight" data-date="2025-07-07">7</div>
                            <div class="calendar-day h-12 flex items-center justify-center rounded-full border-2 border-transparent cursor-pointer highlight" data-date="2025-07-08">8</div>
                            <div class="calendar-day h-12 flex items-center justify-center rounded-full border-2 border-transparent cursor-pointer highlight" data-date="2025-07-09">9</div>
                            <div class="h-12 flex items-center justify-center">10</div>
                            <div class="h-12 flex items-center justify-center">11</div>
                            <div class="h-12 flex items-center justify-center">12</div>
                            
                            <!-- Week 3 -->
                            <div class="h-12 flex items-center justify-center">13</div>
                            <div class="h-12 flex items-center justify-center">14</div>
                            <div class="h-12 flex items-center justify-center">15</div>
                            <div class="h-12 flex items-center justify-center">16</div>
                            <div class="h-12 flex items-center justify-center">17</div>
                            <div class="h-12 flex items-center justify-center">18</div>
                            <div class="h-12 flex items-center justify-center">19</div>
                            
                            <!-- Week 4 -->
                            <div class="h-12 flex items-center justify-center">20</div>
                            <div class="h-12 flex items-center justify-center">21</div>
                            <div class="h-12 flex items-center justify-center">22</div>
                            <div class="h-12 flex items-center justify-center">23</div>
                            <div class="h-12 flex items-center justify-center">24</div>
                            <div class="h-12 flex items-center justify-center">25</div>
                            <div class="h-12 flex items-center justify-center">26</div>
                            
                            <!-- Week 5 -->
                            <div class="h-12 flex items-center justify-center">27</div>
                            <div class="h-12 flex items-center justify-center">28</div>
                            <div class="h-12 flex items-center justify-center">29</div>
                            <div class="h-12 flex items-center justify-center">30</div>
                            <div class="h-12 flex items-center justify-center">31</div>
                            <div class="h-12 flex items-center justify-center text-gray-400">1</div>
                            <div class="h-12 flex items-center justify-center text-gray-400">2</div>
                        </div>
                    </div>
                </div>
                
                <!-- Registration Form -->
                <form id="registrationForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Group Name -->
                        <div>
                            <label for="groupName" class="block text-sm font-medium text-gray-700 mb-1">단체명 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="ri-team-line text-gray-400"></i>
                                </div>
                                <input type="text" id="groupName" name="groupName" class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-primary focus:ring-opacity-20" placeholder="단체명을 입력해주세요" required>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">예: 체육회초등학교</p>
                            <p class="error-message text-sm text-red-500 mt-1 hidden">단체명을 입력해주세요</p>
                        </div>
                        
                        <!-- Manager Name -->
                        <div>
                            <label for="managerName" class="block text-sm font-medium text-gray-700 mb-1">담당자 성함 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="ri-user-line text-gray-400"></i>
                                </div>
                                <input type="text" id="managerName" name="managerName" class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-primary focus:ring-opacity-20" placeholder="담당자 성함을 입력해주세요" required>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">예: 김민준</p>
                            <p class="error-message text-sm text-red-500 mt-1 hidden">담당자 성함을 입력해주세요</p>
                        </div>
                        
                        <!-- Contact Number -->
                        <div>
                            <label for="contactNumber" class="block text-sm font-medium text-gray-700 mb-1">담당자 연락처 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="ri-phone-line text-gray-400"></i>
                                </div>
                                <input type="tel" id="contactNumber" name="contactNumber" class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-primary focus:ring-opacity-20" placeholder="연락처를 입력해주세요" required>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">예: 010-1234-5678</p>
                            <p class="error-message text-sm text-red-500 mt-1 hidden">유효한 연락처를 입력해주세요</p>
                        </div>
                        
                        <!-- Participant Count -->
                        <div>
                            <label for="participantCount" class="block text-sm font-medium text-gray-700 mb-1">참가 인원 <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="ri-group-line text-gray-400"></i>
                                </div>
                                <input type="number" id="participantCount" name="participantCount" min="10" max="44" class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded text-gray-900 placeholder-gray-400 focus:ring-2 focus:ring-primary focus:ring-opacity-20" placeholder="참가 인원을 입력해주세요 (최소 10명)" required>
                            </div>
                            <p class="text-sm text-gray-500 mt-1"><strong class="text-primary">인솔자 포함 최소 10명</strong>, 최대 44명</strong>까지 가능합니다</p>
                            <p class="error-message text-sm text-red-500 mt-1 hidden">유효한 참가 인원을 입력해주세요 (10-44명)</p>
                        </div>
                    </div>
                    
                    <!-- Selected Date -->
                    <div>
                        <label for="selectedDate" class="block text-sm font-medium text-gray-700 mb-1">선택한 날짜 <span class="text-red-500">*</span></label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="ri-calendar-check-line text-gray-400"></i>
                            </div>
                            <input type="text" id="selectedDate" name="selectedDate" class="block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded text-gray-900 placeholder-gray-400 bg-gray-50 focus:ring-2 focus:ring-primary focus:ring-opacity-20" placeholder="날짜를 선택해주세요" readonly required>
                        </div>
                        <p class="error-message text-sm text-red-500 mt-1 hidden">날짜를 선택해주세요</p>
                    </div>
                    
                    <!-- Submit Button -->
                    <div class="pt-4">
                        <button type="submit" id="submitButton" class="w-full md:w-auto px-6 py-3 bg-primary text-white font-medium rounded-button shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap" disabled>
                            신청하기
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Additional Information -->
            <div class="mt-12 bg-white rounded-xl shadow-sm border border-gray-100 p-6 md:p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">이벤트 안내사항</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                            <div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-primary rounded-full mr-2">
                                <i class="ri-information-line"></i>
                            </div>
                            주의사항
                        </h3>
                        <ul class="space-y-3 text-gray-600">
                            <li class="flex items-start">
                                <div class="flex-shrink-0 w-5 h-5 flex items-center justify-center text-primary mt-0.5">
                                    <i class="ri-checkbox-circle-line"></i>
                                </div>
                                <span class="ml-2">참가단체 선정은 선착순 접수를 원칙으로 합니다.</span>
                            </li>
                            <li class="flex items-start">
                                <div class="flex-shrink-0 w-5 h-5 flex items-center justify-center text-primary mt-0.5">
                                    <i class="ri-checkbox-circle-line"></i>
                                </div>
                                <span class="ml-2">신청 후 선정이 될 경우 별도의 안내 메시지가 발송됩니다.</span>
                            </li>
                            <li class="flex items-start">
                                <div class="flex-shrink-0 w-5 h-5 flex items-center justify-center text-primary mt-0.5">
                                    <i class="ri-checkbox-circle-line"></i>
                                </div>
                                <span class="ml-2">선정이 되지 않을 경우 별도의 안내 메시지는 발송되지 않습니다.</span>
                            </li>
                            <li class="flex items-start">
                                <div class="flex-shrink-0 w-5 h-5 flex items-center justify-center text-primary mt-0.5">
                                    <i class="ri-checkbox-circle-line"></i>
                                </div>
                                <span class="ml-2">우천 시 행사가 취소 또는 연기될 수 있으며, 이 경우 별도 공지됩니다.</span>
                            </li>
                        </ul>
                    </div>
                
                <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-700 mb-2 flex items-center">
                        <div class="w-6 h-6 flex items-center justify-center text-primary mr-2">
                            <i class="ri-customer-service-2-line"></i>
                        </div>
                        문의 연락처
                    </h3>
                    <p class="text-gray-600">궁금한 사항은 아래 연락처로 문의해 주세요:</p>
                    <div class="mt-2 flex flex-col sm:flex-row sm:space-x-6">
                        <div class="flex items-center mt-2">
                            <div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-primary rounded-full mr-2">
                                <i class="ri-phone-line"></i>
                            </div>
                            <span class="text-gray-700">031-250-0474~7</span>
                        </div>
                        <div class="flex items-center mt-2">
                            <div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-primary rounded-full mr-2">
                                <i class="ri-mail-line"></i>
                            </div>
                            <span class="text-gray-700">p705321@ggsc.or.kr</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="bg-gray-800 text-white mt-auto">
            <div class="container mx-auto px-4 md:px-8 py-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <img src="https://raw.githubusercontent.com/sportsbox031/event/main/KakaoTalk_20250423_132034560.png" alt="스포츠박스 로고" class="h-14 w-auto mb-2">
                        <p class="text-gray-400">경기도체육회 스포츠박스 2025</p>
                    </div>
                    <div class="text-right">
                        <p class="text-gray-400">문의: 031-250-0474~7</p>
                        <p class="text-gray-400">이메일: p705321@ggsc.or.kr</p>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
                    © 2025 스포츠박스. All rights reserved.
                </div>
                <button id="adminLoginBtn" class="admin-login-btn">관리자 로그인</button>
            </div>
        </footer>
    </div>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-lg p-8 max-w-md w-full relative z-10">
            <div class="text-center">
                <div class="w-12 h-12 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4 animate-spin"></div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">처리 중...</h3>
                <p class="text-gray-600">잠시만 기다려주세요.</p>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-lg p-8 max-w-md w-full relative z-10">
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ri-check-line text-green-500 text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">신청이 완료되었습니다!</h3>
                <p class="text-gray-600 mb-6">신청 내용을 확인한 후 담당자가 연락드릴 예정입니다.</p>
                <button id="closeSuccessModal" class="px-6 py-2 bg-primary text-white font-medium rounded-button shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors whitespace-nowrap">
                    확인
                </button>
            </div>
        </div>
    </div>

    <!-- Duplicate Submission Modal -->
    <div id="duplicateModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-lg p-8 max-w-md w-full relative z-10">
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ri-error-warning-line text-red-500 text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">중복 신청</h3>
                <p class="text-gray-600 mb-6">같은 단체명으로 해당 날짜에 이미 신청 내역이 있습니다.</p>
                <button id="closeDuplicateModal" class="px-6 py-2 bg-primary text-white font-medium rounded-button shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors whitespace-nowrap">
                    확인
                </button>
            </div>
        </div>
    </div>

    <!-- Low Participant Count Modal -->
<div id="lowParticipantModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    <div class="bg-white rounded-lg p-8 max-w-md w-full relative z-10">
        <div class="text-center">
            <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="ri-error-warning-line text-yellow-500 text-3xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">참가 인원 부족</h3>
            <p class="text-gray-600 mb-6">참가 인원은 최소 10명 이상이어야 합니다.</p>
            <button id="closeLowParticipantModal" class="px-6 py-2 bg-primary text-white font-medium rounded-button shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors whitespace-nowrap">
                확인
            </button>
        </div>
    </div>
</div>

    <!-- Admin Panel Modal -->
    <div id="adminPanel" class="fixed inset-0 flex items-center justify-center z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-lg p-6 max-w-md w-full relative z-10">
            <div class="text-center mb-4">
                <h2 class="text-xl font-bold text-gray-900">관리자 설정</h2>
            </div>
            
            <div class="space-y-4">
                <!-- 예약 상태 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">예약 상태</h3>
                    <div id="reservationStatus" class="text-center p-2 rounded mb-3">
                        확인 중...
                    </div>
                    <button onclick="toggleReservation()" class="w-full px-4 py-2 bg-primary text-white rounded hover:bg-blue-600 transition-colors">
                        예약 시작/중지
                    </button>
                </div>

                <!-- 비밀번호 변경 -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-base font-semibold text-gray-700 mb-2">비밀번호 변경</h3>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">현재 비밀번호</label>
                            <input type="password" id="currentPassword" class="w-full p-2 border rounded focus:ring-2 focus:ring-primary focus:ring-opacity-20">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">새 비밀번호</label>
                            <input type="password" id="newPassword" class="w-full p-2 border rounded focus:ring-2 focus:ring-primary focus:ring-opacity-20">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">새 비밀번호 확인</label>
                            <input type="password" id="confirmPassword" class="w-full p-2 border rounded focus:ring-2 focus:ring-primary focus:ring-opacity-20">
                        </div>
                        <button onclick="changePassword()" class="w-full px-4 py-2 bg-primary text-white rounded hover:bg-blue-600 transition-colors">
                            비밀번호 변경
                        </button>
                    </div>
                </div>
            </div>

            <div class="mt-4 text-center">
                <button onclick="closeAdminPanel()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors">
                    닫기
                </button>
            </div>
        </div>
    </div>

    <script>
        // 예약 상태 확인 함수를 먼저 정의
        function checkReservationStatus() {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
            
            fetch(`${scriptURL}?action=getStatus`)
                .then(response => response.json())
                .then(data => {
                    const statusText = document.getElementById('statusText');
                    const statusDisplay = document.getElementById('reservationStatusDisplay');
                    const calendarDays = document.querySelectorAll('.calendar-day');
                    const submitButton = document.getElementById('submitButton');
                    
                    if (data.result === 'success') {
                        const isOpen = data.status === 'open';
                        
                        // 상태 텍스트 업데이트
                        statusText.textContent = isOpen ? '예약 진행 중' : '예약 중지';
                        statusDisplay.className = `mb-4 p-3 rounded-lg text-center ${isOpen ? 'bg-green-100' : 'bg-red-100'}`;
                        
                        // 캘린더와 제출 버튼 상태 업데이트
                        calendarDays.forEach(day => {
                            day.style.pointerEvents = isOpen ? 'auto' : 'none';
                            day.style.opacity = isOpen ? '1' : '0.5';
                            if (!isOpen) {
                                day.title = '현재 예약이 중지되었습니다.';
                            } else {
                                day.title = '';
                            }
                        });
                        
                        submitButton.disabled = !isOpen;
                        if (!isOpen) {
                            submitButton.title = '현재 예약이 중지되었습니다.';
                        } else {
                            submitButton.title = '';
                        }
                    }
                })
                .catch(error => {
                    console.error('Error checking status:', error);
                    // 오류 발생 시 상태 표시 업데이트
                    const statusText = document.getElementById('statusText');
                    const statusDisplay = document.getElementById('reservationStatusDisplay');
                    statusText.textContent = '상태 확인 중 오류 발생';
                    statusDisplay.className = 'mb-4 p-3 rounded-lg text-center bg-yellow-100';
                });
        }

        // 관리자 패널에서 상태 변경 시 메인 페이지 상태도 업데이트
        function toggleReservation() {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
            
            // 로딩 상태 표시
            const statusDiv = document.getElementById('reservationStatus');
            if (statusDiv) {
                statusDiv.textContent = '처리 중...';
                statusDiv.className = 'text-center p-2 rounded mb-3 bg-gray-100 text-gray-700';
            }
            
            fetch(`${scriptURL}?action=toggleStatus`)
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        loadAdminData();
                        // 메인 페이지의 예약 상태도 즉시 업데이트
                        checkReservationStatus();
                    } else {
                        alert(data.message || '상태 변경 중 오류가 발생했습니다.');
                        if (data.message && data.message.includes('세션이 만료')) {
                            closeAdminPanel();
                        }
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('상태 변경 중 오류가 발생했습니다.');
                    loadAdminData();
                });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // 페이지 로드 시 예약 상태 확인
            checkReservationStatus();
            
            // 1분마다 예약 상태 확인
            setInterval(checkReservationStatus, 60000);

            const calendarDays = document.querySelectorAll('.calendar-day');
            const selectedDateInput = document.getElementById('selectedDate');
            const registrationForm = document.getElementById('registrationForm');
            const submitButton = document.getElementById('submitButton');
            const successModal = document.getElementById('successModal');
            const closeSuccessModal = document.getElementById('closeSuccessModal');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const duplicateModal = document.getElementById('duplicateModal');
            const closeDuplicateModal = document.getElementById('closeDuplicateModal');
            
            // Calendar date selection
            calendarDays.forEach(day => {
                day.addEventListener('click', function() {
                    // Remove selected class from all days
                    calendarDays.forEach(d => d.classList.remove('selected'));
                    
                    // Add selected class to clicked day
                    this.classList.add('selected');
                    
                    // Update selected date input
                    const date = this.dataset.date;
                    const dateObj = new Date(date);
                    const formattedDate = `${dateObj.getFullYear()}년 ${dateObj.getMonth() + 1}월 ${dateObj.getDate()}일`;
                    selectedDateInput.value = formattedDate;
                    // 원본 날짜 값을 데이터 속성으로 저장
                    selectedDateInput.dataset.originalDate = date;
                    
                    // Validate form
                    validateForm();
                });
            });
            
            // Helper functions - 함수 정의 순서를 변경했습니다
            function showError(input, message) {
                const parentDiv = input.closest('div');
                const errorElement = parentDiv.querySelector('.error-message');
                
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.remove('hidden');
                }
                input.classList.add('border-red-500');
            }
            
            function hideError(input) {
                const parentDiv = input.closest('div');
                const errorElement = parentDiv.querySelector('.error-message');
                
                if (errorElement) {
                    errorElement.classList.add('hidden');
                }
                input.classList.remove('border-red-500');
            }
            
            function validateInput(input) {
                if (input.value.trim() === '') {
                    const fieldName = input.previousElementSibling.textContent.replace('*', '').trim();
                    showError(input, `${fieldName}을(를) 입력해주세요`);
                    return false;
                } else {
                    hideError(input);
                    return true;
                }
            }
            
            function validateForm() {
                let isValid = true;
                
                inputs.forEach(input => {
                    if (!validateInput(input)) {
                        isValid = false;
                    }
                });
                
                // Additional validation for participant count
                const participantCount = parseInt(participantCountInput.value);
                if (isNaN(participantCount) || participantCount < 10 || participantCount > 44) {
                    isValid = false;
                }
                
                // Additional validation for contact number
                const phoneRegex = /^01[0-9]-?[0-9]{3,4}-?[0-9]{4}$/;
                if (!phoneRegex.test(contactNumberInput.value.replace(/-/g, ''))) {
                    isValid = false;
                }
                
                submitButton.disabled = !isValid;
                return isValid;
            }
            
            // Form validation
            const inputs = registrationForm.querySelectorAll('input[required]');
            inputs.forEach(input => {
                input.addEventListener('input', validateForm);
                input.addEventListener('blur', function() {
                    validateInput(this);
                });
            });
            
            // Specific validation for participant count
            const participantCountInput = document.getElementById('participantCount');
            participantCountInput.addEventListener('input', function() {
                const value = parseInt(this.value);
                if (isNaN(value) || value < 10 || value > 44) {
                    showError(this, '유효한 참가 인원을 입력해주세요 (10-44명)');
                } else {
                    hideError(this);
                }
                validateForm();
            });
            
            // Specific validation for contact number
            const contactNumberInput = document.getElementById('contactNumber');
            contactNumberInput.addEventListener('input', function() {
                // Allow digits and hyphens
                this.value = this.value.replace(/[^\d-]/g, '');
                
                // Basic phone number validation
                const phoneRegex = /^01[0-9]-?[0-9]{3,4}-?[0-9]{4}$/;
                if (!phoneRegex.test(this.value.replace(/-/g, ''))) {
                    showError(this, '유효한 연락처를 입력해주세요');
                } else {
                    hideError(this);
                }
                validateForm();
            });
            
            // 인원 수 미달 모달 닫기 버튼 이벤트
            const closeLowParticipantModal = document.getElementById('closeLowParticipantModal');
            if (closeLowParticipantModal) {
                closeLowParticipantModal.addEventListener('click', function() {
                    document.getElementById('lowParticipantModal').classList.add('hidden');
                });
            }

            // Form submission
            registrationForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 참가 인원에 대한 명시적 검증
                const participantCount = parseInt(document.getElementById('participantCount').value);
                if (isNaN(participantCount) || participantCount < 10) {
                    // 인원 수 미달 모달 표시
                    document.getElementById('lowParticipantModal').classList.remove('hidden');
                    return; // 제출 중단
                }

                if (validateForm()) {
                    // 로딩 인디케이터 표시
                    const loadingIndicator = document.getElementById('loadingIndicator');
                    if (loadingIndicator) loadingIndicator.classList.remove('hidden');
                    
                    submitButton.disabled = true;
                    
                    // 폼 데이터 수집
                    const formData = {
                        '단체명': document.getElementById('groupName').value,
                        '담당자 성함': document.getElementById('managerName').value,
                        '담당자 연락처': document.getElementById('contactNumber').value,
                        '참가 인원': document.getElementById('participantCount').value,
                        '선택한 날짜': document.getElementById('selectedDate').value
                    };
                    
                    console.log('폼 데이터:', formData); // 디버깅용 로그
                        
                    // Google Apps Script 웹앱 URL
                    const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
                    
                    // 데이터 전송 - form-urlencoded 형식 사용
                    fetch(scriptURL, {
                        method: 'POST',
                        mode: 'no-cors',
                        cache: 'no-cache',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(formData).toString()
                    })
                    .then(response => {
                        // 로딩 인디케이터 숨기기
                        if (loadingIndicator) loadingIndicator.classList.add('hidden');
                        
                        // 응답 처리
                        const successModal = document.getElementById('successModal');
                        if (successModal) successModal.classList.remove('hidden');
                        
                        // 폼 초기화
                        registrationForm.reset();
                        const calendarDays = document.querySelectorAll('.calendar-day');
                        calendarDays.forEach(day => day.classList.remove('selected'));
                        submitButton.disabled = true;
                    })
                    .catch(error => {
                        console.error('Error!', error.message);
                        if (loadingIndicator) loadingIndicator.classList.add('hidden');
                        alert('제출 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.');
                        submitButton.disabled = false;
                    });
                }
            });
            
            // Close success modal
            closeSuccessModal.addEventListener('click', function() {
                successModal.classList.add('hidden');
            });
            
            // Close duplicate modal
            closeDuplicateModal.addEventListener('click', function() {
                duplicateModal.classList.add('hidden');
            });
        });

        // 관리자 패널 관련 함수들
        function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            loadAdminData();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function loadAdminData() {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
            
            // 로딩 상태 표시
            const statusDiv = document.getElementById('reservationStatus');
            if (statusDiv) {
                statusDiv.textContent = '로딩 중...';
                statusDiv.className = 'text-center p-2 rounded mb-3 bg-gray-100 text-gray-700';
            }
            
            fetch(`${scriptURL}?action=getStatus`)
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        if (statusDiv) {
                            statusDiv.textContent = `현재 상태: ${data.status === 'open' ? '예약 진행 중' : '예약 중지'}`;
                            statusDiv.className = `text-center p-2 rounded mb-3 ${data.status === 'open' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`;
                        }
                    } else {
                        if (statusDiv) {
                            statusDiv.textContent = data.message || '상태를 불러오는 중 오류가 발생했습니다.';
                            statusDiv.className = 'text-center p-2 rounded mb-3 bg-red-100 text-red-700';
                        }
                        if (data.message && data.message.includes('세션이 만료')) {
                            closeAdminPanel();
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading status:', error);
                    if (statusDiv) {
                        statusDiv.textContent = '상태를 불러오는 중 오류가 발생했습니다.';
                        statusDiv.className = 'text-center p-2 rounded mb-3 bg-red-100 text-red-700';
                    }
                });
        }

        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('모든 필드를 입력해주세요.');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('새 비밀번호가 일치하지 않습니다.');
                return;
            }

            // 비밀번호 유효성 검사
            if (newPassword.length < 8) {
                alert('비밀번호는 8자 이상이어야 합니다.');
                return;
            }
            
            if (!/[A-Z]/.test(newPassword)) {
                alert('비밀번호는 대문자를 포함해야 합니다.');
                return;
            }
            
            if (!/[a-z]/.test(newPassword)) {
                alert('비밀번호는 소문자를 포함해야 합니다.');
                return;
            }
            
            if (!/[0-9]/.test(newPassword)) {
                alert('비밀번호는 숫자를 포함해야 합니다.');
                return;
            }
            
            if (!/[!@#$%^&*]/.test(newPassword)) {
                alert('비밀번호는 특수문자(!@#$%^&*)를 포함해야 합니다.');
                return;
            }

            const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
            
            // 로딩 상태 표시
            const button = document.querySelector('button[onclick="changePassword()"]');
            const originalText = button.textContent;
            button.textContent = '처리 중...';
            button.disabled = true;
            
            fetch(`${scriptURL}?action=changePassword&current=${encodeURIComponent(currentPassword)}&new=${encodeURIComponent(newPassword)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.result === 'success') {
                        alert('비밀번호가 변경되었습니다.');
                        document.getElementById('currentPassword').value = '';
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmPassword').value = '';
                    } else {
                        alert(data.message || '비밀번호 변경 중 오류가 발생했습니다.');
                        if (data.message && data.message.includes('세션이 만료')) {
                            closeAdminPanel();
                        }
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('비밀번호 변경 중 오류가 발생했습니다.');
                })
                .finally(() => {
                    button.textContent = originalText;
                    button.disabled = false;
                });
        }

        function addAdmin() {
            const email = document.getElementById('newAdminEmail').value;
            if (!email) {
                alert('이메일 주소를 입력해주세요.');
                return;
            }

            const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
            
            fetch(`${scriptURL}?action=addAdmin&email=${encodeURIComponent(email)}`)
                .then(response => response.json())
                .then(() => {
                    document.getElementById('newAdminEmail').value = '';
                    loadAdminData();
                });
        }

        function removeAdmin(email) {
            if (confirm('정말로 이 관리자를 삭제하시겠습니까?')) {
                const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
                
                fetch(`${scriptURL}?action=removeAdmin&email=${encodeURIComponent(email)}`)
                    .then(response => response.json())
                    .then(() => {
                        loadAdminData();
                    });
            }
        }

        // 관리자 로그인 처리 수정
        document.getElementById('adminLoginBtn').addEventListener('click', function() {
            const email = prompt('관리자 이메일을 입력해주세요:');
            if (email) {
                const password = prompt('비밀번호를 입력해주세요:');
                if (password) {
                    const scriptURL = 'https://script.google.com/macros/s/AKfycbz605Ty74W6zjEyYYAcEJEWzHsejWFj__3T1WBvr9RJjAPzEKmM9-cQKAZExIdalb3K/exec';
                    
                    // 로딩 상태 표시
                    const loadingIndicator = document.getElementById('loadingIndicator');
                    if (loadingIndicator) loadingIndicator.classList.remove('hidden');
                    
                    // URL 파라미터 인코딩
                    const params = new URLSearchParams({
                        page: 'admin',
                        email: email,
                        password: password
                    });
                    
                    fetch(`${scriptURL}?${params.toString()}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.result === 'success') {
                                showAdminPanel();
                            } else {
                                alert(data.message || '로그인에 실패했습니다.');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            alert('로그인 중 오류가 발생했습니다.');
                        })
                        .finally(() => {
                            if (loadingIndicator) loadingIndicator.classList.add('hidden');
                        });
                }
            }
        });
    </script>
</body>
</html>
